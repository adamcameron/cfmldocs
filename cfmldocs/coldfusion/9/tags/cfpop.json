{"HISTORY":"<!-- --><br>ColdFusion MX 7.01: Added cids query variable.<br>ColdFusion MX 6.1:<br><li><p>Added support for multipart mail messages with Text and HTML parts.<\/p> <\/li> \n<li><p>Changed the attachment name separator: the TAB character is now the separator between attachment names in the <samp class=\"codeph\">attachments<\/samp> and <samp class=\"codeph\">attachmentfiles<\/samp> query fields if a message has multiple attachments. This behavior is identical to ColdFusion 5 and earlier versions.<\/p> <\/li><br>ColdFusion MX: Changed the attachment name separator: the comma separates names in the <samp class=\"codeph\">attachments<\/samp> and <samp class=\"codeph\">attachmentfiles<\/samp> query fields if a message has multiple attachments.<br>","SYNTAX":"<!-- --><br>&lt;cfpop  \r\n    server = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">server name<\/i>&quot; \r\n    action = &quot;getHeaderOnly|getAll|delete&quot; \r\n    attachmentPath = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">path<\/i>&quot; \r\n    debug = &quot;yes|no&quot;&gt; \r\n    generateUniqueFilenames = &quot;yes|no&quot; \r\n    maxRows = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">number<\/i>&quot; \r\n    messageNumber = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">number<\/i>&quot; \r\n    name = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">query name<\/i>&quot; \r\n    password = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">password<\/i>&quot; \r\n    port = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">port number<\/i>&quot; \r\n    startRow = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">number<\/i>&quot; \r\n    timeout = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">seconds<\/i>&quot; \r\n    uid = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">number<\/i>&quot; \r\n    username = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">user name<\/i>&quot;&gt;<br><span class=\"notetitle\">Note: <\/span>You can specify this tag’s attributes in an \n<samp class=\"codeph\">attributeCollection<\/samp> attribute whose value is a structure. Specify the structure name in the \n<samp class=\"codeph\">attributeCollection<\/samp> attribute and use the tag’s attribute names as structure keys.<br>","CATEGORY":"Communications tags, Internet protocol tags","PAGENAME":"cfpop","SEEALSO":"<!-- --><br><samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7c7d.html\">cfftp<\/a><\/samp>, <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7ffc.html\">cfhttp<\/a><\/samp>, <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7f97.html\">cfldap<\/a><\/samp>, <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7f8e.html\">cfmail<\/a><\/samp>, <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7c15.html\">cfmailparam<\/a><\/samp>, <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7fa3.html\">SetLocale<\/a><\/samp>; <a href=\"http:\/\/help.adobe.com\/en_US\/ColdFusion\/9.0\/Developing\/WSc3ff6d0ea77859461172e0811cbec22c24-782a.html\" target=\"_self\">Sending and Receiving E-Mail<\/a> in the <i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">Developing ColdFusion Applications<\/i><br>","DESCRIPTION":"Retrieves or deletes e-mail messages from a POP mail server.","LICENCE":"http:\/\/help.adobe.com\/en_US\/ColdFusion\/10.0\/LegalNotices\/index.html","EXAMPLE":"<!-- --><br>&lt;!--- This view-only example shows the use of cfpop. ---&gt; \r\n&lt;h3&gt;cfpop Example&lt;\/h3&gt; \r\n&lt;p&gt;cfpop lets you retrieve and manipulate mail in a POP3 mailbox.  \r\n    This view-only example shows how to create one feature of  \r\n    a mail client, to display the mail headers in a POP3 mailbox. \r\n&lt;p&gt;To execute this, un-comment this code and run with a mail-enabled CF Server. \r\n&lt;!---  \r\n&lt;cfif IsDefined(&quot;form.server&quot;)&gt; \r\n    &lt;!--- Make sure server, username are not empty. ---&gt; \r\n    &lt;cfif form.server is not &quot;&quot; and form.username is not &quot;&quot;&gt; \r\n        &lt;cfpop server = &quot;#form.popserver# &quot; username = #form.username# password = #form.pwd# \r\n        action = &quot;getHeaderOnly&quot; name = &quot;GetHeaders &quot;&gt; \r\n        &lt;h3&gt;Message Headers in Your Inbox&lt;\/h3&gt; \r\n        &lt;p&gt;Number of Records:  \r\n        &lt;cfoutput&gt;#GetHeaders.recordCount#&lt;\/cfoutput&gt;&lt;\/p&gt; \r\n \r\n        &lt;ul&gt; \r\n            &lt;cfoutput query = &quot;GetHeaders&quot;&gt; \r\n            &lt;li&gt;Row: #currentRow#: From: #From# -- Subject: #Subject# \r\n            &lt;\/cfoutput&gt; \r\n        &lt;\/ul&gt; \r\n    &lt;\/cfif&gt; \r\n&lt;\/cfif&gt; \r\n \r\n&lt;form action = &quot;cfpop.cfm &quot; method = &quot;post&quot;&gt; \r\n    &lt;p&gt;Enter your mail server:&lt;\/p&gt; \r\n    &lt;p&gt;&lt;input type = &quot;Text&quot; name = &quot;popserver&quot;&gt;&lt;\/p&gt; \r\n    &lt;p&gt;Enter your username:&lt;\/p&gt; \r\n    &lt;p&gt;&lt;input type = &quot;Text&quot; name = &quot;username&quot;&gt;&lt;\/p&gt; \r\n    &lt;p&gt;Enter your password:&lt;\/p&gt; \r\n    &lt;p&gt;&lt;input type = &quot;password&quot; name = &quot;pwd&quot;&gt;&lt;\/p&gt; \r\n    &lt;p&gt;&lt;input type = &quot;Submit&quot; name = &quot;get message headers&quot;&gt;&lt;\/p&gt; \r\n&lt;\/form&gt;  \r\n---&gt;<br>","USAGE":"<!-- --><br>The <samp class=\"codeph\">cfpop<\/samp> tag retrieves one or more mail messages from a POP server and populates a ColdFusion query object with the resulting messages, one message per row. Alternatively, it deletes one or more messages from the POP server.<br><span class=\"notetitle\">Note: <\/span>When the \n<samp class=\"codeph\">cfpop<\/samp> tag encounters malformed mail messages, it does not generate errors; instead, it returns empty fields.<br>To optimize performance, two retrieve options are available. Message header information is typically short, and therefore quick to transfer. Message text and attachments can be long, and therefore take longer to process.<br>","Attribute":[{"REQOROPT":"Required","DESCRIPTION":"POP server identifier: A host name, for example, \"biff.upperlip.com\". An IP address, for example, \"192.1.2.225\".","default":"","Attribute":"server"},{"REQOROPT":"Optional","DESCRIPTION":"getHeaderOnly: returns message header information only getAll: returns message header information, message text, and attachments if attachmentPath is specified delete: deletes messages on POP server","default":"getHeaderOnly","Attribute":"action"},{"REQOROPT":"Optional","DESCRIPTION":"If action=\"getAll\", specifies a directory in which to save any attachments. If the directory does not exist, ColdFusion creates it. If you omit this attribute, ColdFusion does not save any attachments. If you specify a relative path, the path root is the ColdFusion temporary directory, which is returned by the GetTempDirectory function.","default":"","Attribute":"attachmentPath"},{"REQOROPT":"Optional","DESCRIPTION":"yes: sends debugging output to standard output. By default, if the console window is unavailable on server configurations, ColdFusion sends output to cf_root\/runtime\/logs\/coldfusion-out.log. On J2EE configurations, with JRun, the default location is jrun_home\/logs\/servername‑out.log. Caution: If you set this option to Yes, ColdFusion writes detailed debugging information to the log, including all retrieved message contents, and can generate large logs quickly. no: does not generate debugging output.","default":false,"Attribute":"debug"},{"REQOROPT":"Optional","DESCRIPTION":"yes: generate unique filenames for files attached to an e-mail message, to avoid naming conflicts when files are saved. no","default":false,"Attribute":"generateUniqueFilenames"},{"REQOROPT":"Optional","DESCRIPTION":"Number of messages to return or delete, starting with the number in startRow. Ignored if messageNumber or uid is specified.","default":"Retrieves all available rows","Attribute":"maxRows"},{"REQOROPT":" ","DESCRIPTION":"Message number or comma-separated list of message numbers to get or delete. Invalid message numbers are ignored. Ignored if uid is specified.","default":"","Attribute":"messageNumber"},{"REQOROPT":"Required if action=\"getAll\" or \"getHeaderOnly\"","DESCRIPTION":"Name for query object that contains the retrieved message information.","default":"","Attribute":"name"},{"REQOROPT":"Optional","DESCRIPTION":"Password that corresponds to username.","default":"","Attribute":"password"},{"REQOROPT":"Optional","DESCRIPTION":"POP port.","default":110,"Attribute":"port"},{"REQOROPT":"Optional","DESCRIPTION":"First row number to get or delete. Ignored if messageNumber or uid is specified.","default":1,"Attribute":"startRow"},{"REQOROPT":"Optional","DESCRIPTION":"Maximum time, in seconds, to wait for mail processing.","default":60,"Attribute":"timeout"},{"REQOROPT":" ","DESCRIPTION":"UID or a comma-separated list of UIDs to get or delete. Invalid UIDs are ignored.","default":"","Attribute":"uid"},{"REQOROPT":"Optional","DESCRIPTION":"A user name.","default":"","Attribute":"username"}]}