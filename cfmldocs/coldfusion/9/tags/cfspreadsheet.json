{"HISTORY":"<!-- --><br>ColdFusion 9.0.1: Added the attribute <samp class=\"codeph\">excludeHeaderRow<\/samp><br>ColdFusion 9: Added this tag.<br>","SYNTAX":"<!-- --><br>The tag syntax depends on the <samp class=\"codeph\">action<\/samp> attribute value:<br><strong>Read<\/strong> \r\n&lt;cfspreadsheet  \r\n    action=&quot;read&quot; \r\n    src = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">filepath<\/i>&quot; \r\n    columns = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">range<\/i>&quot; \r\n    columnnames = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">comma-delimited list<\/i>&quot; \r\n    excludeHeaderRow = &quot;true | false&quot; \r\n    format = &quot;CSV|HTML&quot; \r\n    headerrow = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">row number<\/i>&quot; \r\n    name = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">text<\/i>&quot; \r\n    query = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">query name<\/i>&quot; \r\n    rows = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">range<\/i>&quot; \r\n    sheet = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">number<\/i>&quot; \r\n    sheetname = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">text<\/i>&quot;&gt; \r\n \r\n<strong>Update<\/strong> \r\n&lt;cfspreadsheet \r\n    action=&quot;update&quot; \r\n    filename = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">filepath<\/i>&quot; \r\n    format = &quot;csv&quot; \r\n    name = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">text<\/i>&quot; \r\n    password = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">password<\/i>&quot; \r\n    query = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">query name<\/i>&quot; \r\n    sheetname = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">text<\/i>&quot; &gt; \r\n \r\n<strong>Write<\/strong> \r\n&lt;cfspreadsheet  \r\n    action=&quot;write&quot; \r\n    filename = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">filepath<\/i>&quot; \r\n    format = &quot;csv&quot; \r\n    name = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">text<\/i>&quot; \r\n    overwrite = &quot;true | false&quot; \r\n    password = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">password<\/i>&quot; \r\n    query = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">queryname<\/i>&quot; \r\n    sheetname = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">text<\/i>&quot; &gt;<br>","CATEGORY":"Extensibility tags","PAGENAME":"cfspreadsheet","SEEALSO":"<!-- --><br>Sreadsheet functions.<br>","DESCRIPTION":"Manages Excel spreadsheet files:","LICENCE":"http:\/\/help.adobe.com\/en_US\/ColdFusion\/10.0\/LegalNotices\/index.html","EXAMPLE":"<!-- --><br>The following example uses the cfspreadsheet tag to read and write Excel spreadsheets using various formats. It also shows a simple use of ColdFusion Spreadsheet functions to modify a sheet.<br>&lt;!--- Read data from two datasource tables. ---&gt; \r\n&lt;cfquery \r\n       name=&quot;courses&quot; datasource=&quot;cfdocexamples&quot; \r\n       cachedwithin=&quot;#CreateTimeSpan(0, 6, 0, 0)#&quot;&gt; \r\n       SELECT CORNUMBER,DEPT_ID,COURSE_ID,CORNAME \r\n       FROM COURSELIST \r\n&lt;\/cfquery&gt; \r\n \r\n&lt;cfquery \r\n       name=&quot;centers&quot; datasource=&quot;cfdocexamples&quot; \r\n       cachedwithin=&quot;#CreateTimeSpan(0, 6, 0, 0)#&quot;&gt; \r\n       SELECT * \r\n       FROM CENTERS \r\n&lt;\/cfquery&gt; \r\n     \r\n&lt;cfscript&gt; \r\n    \/\/Use an absolute path for the files. ---&gt; \r\n       theDir=GetDirectoryFromPath(GetCurrentTemplatePath()); \r\n    theFile=theDir &amp; &quot;courses.xls&quot;; \r\n    \/\/Create two empty ColdFusion spreadsheet objects. ---&gt; \r\n    theSheet = SpreadsheetNew(&quot;CourseData&quot;); \r\n    theSecondSheet = SpreadsheetNew(&quot;CentersData&quot;); \r\n    \/\/Populate each object with a query. ---&gt; \r\n    SpreadsheetAddRows(theSheet,courses); \r\n    SpreadsheetAddRows(theSecondSheet,centers); \r\n&lt;\/cfscript&gt; \r\n \r\n&lt;!--- Write the two sheets to a single file ---&gt; \r\n&lt;cfspreadsheet action=&quot;write&quot; filename=&quot;#theFile#&quot; name=&quot;theSheet&quot;  \r\n    sheetname=&quot;courses&quot; overwrite=true&gt; \r\n&lt;cfspreadsheet action=&quot;update&quot; filename=&quot;#theFile#&quot; name=&quot;theSecondSheet&quot; \r\n    sheetname=&quot;centers&quot;&gt; \r\n \r\n&lt;!--- Read all or part of the file into a spreadsheet object, CSV string, \r\n      HTML string, and query. ---&gt; \r\n&lt;cfspreadsheet action=&quot;read&quot; src=&quot;#theFile#&quot; sheetname=&quot;courses&quot; name=&quot;spreadsheetData&quot;&gt; \r\n&lt;cfspreadsheet action=&quot;read&quot; src=&quot;#theFile#&quot; sheet=1 rows=&quot;3,4&quot; format=&quot;csv&quot; name=&quot;csvData&quot;&gt; \r\n&lt;cfspreadsheet action=&quot;read&quot; src=&quot;#theFile#&quot; format=&quot;html&quot; rows=&quot;5-10&quot; name=&quot;htmlData&quot;&gt; \r\n&lt;cfspreadsheet action=&quot;read&quot; src=&quot;#theFile#&quot; sheetname=&quot;centers&quot; query=&quot;queryData&quot;&gt; \r\n \r\n&lt;h3&gt;First sheet row 3 read as a CSV variable&lt;\/h3&gt; \r\n&lt;cfdump var=&quot;#csvData#&quot;&gt; \r\n \r\n&lt;h3&gt;Second sheet rows 5-10 read as an HTML variable&lt;\/h3&gt; \r\n&lt;cfdump var=&quot;#htmlData#&quot;&gt; \r\n \r\n&lt;h3&gt;Second sheet read as a query variable&lt;\/h3&gt; \r\n&lt;cfdump var=&quot;#queryData#&quot;&gt; \r\n \r\n&lt;!--- Modify the courses sheet. ---&gt; \r\n&lt;cfscript&gt; \r\n    SpreadsheetAddRow(spreadsheetData,&quot;03,ENGL,230,Poetry 1&quot;,8,1); \r\n    SpreadsheetAddColumn(spreadsheetData, \r\n    &quot;Basic,Intermediate,Advanced,Basic,Intermediate,Advanced,Basic,Intermediate,Advanced&quot;, \r\n    3,2,true); \r\n&lt;\/cfscript&gt; \r\n \r\n&lt;!--- Write the updated Courses sheet to a new XLS file ---&gt; \r\n&lt;cfspreadsheet action=&quot;write&quot; filename=&quot;#theDir#updatedFile.xls&quot; name=&quot;spreadsheetData&quot;  \r\n    sheetname=&quot;courses&quot; overwrite=true&gt; \r\n&lt;!--- Write an XLS file containing the data in the CSV variable. ---&gt;     \r\n&lt;cfspreadsheet action=&quot;write&quot; filename=&quot;#theDir#dataFromCSV.xls&quot; name=&quot;CSVData&quot;  \r\n    format=&quot;csv&quot; sheetname=&quot;courses&quot; overwrite=true&gt;<br>","USAGE":"<!-- --><br>Each ColdFusion spreadsheet object represents Excel sheet:<br><li><p>To read an Excel file with multiple sheets, use multiple <samp class=\"codeph\">cfspreadsheet<\/samp> tags with the <samp class=\"codeph\">read<\/samp> option and specify different <samp class=\"codeph\">name<\/samp> and <samp class=\"codeph\">sheet<\/samp> or <samp class=\"codeph\">sheetname<\/samp> attributes for each sheet. <\/p> <\/li> \n<li><p>To write multiple sheets to a single file, use the <samp class=\"codeph\">write<\/samp> action to create the file and save the first sheet and use the <samp class=\"codeph\">update<\/samp> action to add each additional sheet.<\/p> <\/li> \n<li><p>To update an existing file, read all sheets in the file, modify one or more sheets, and use the contents, and use the <samp class=\"codeph\">write<\/samp> action and <samp class=\"codeph\">Update<\/samp> actions (for multiple sheet files) to rewrite the entire file.<\/p> <\/li><br>The <samp class=\"codeph\">cfspreadsheet<\/samp> tag writes only XLS format files. To write a CSV file, put your data in a CSV formatted string variable and use the <samp class=\"codeph\">cffile<\/samp> tag to write the variable contents in a file.<br>Use the ColdFusion Spreadsheet* functions, such as <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-747b.html\">SpreadsheetNew<\/a><\/samp> and <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7478.html\">SpreadsheetAddColumn<\/a><\/samp> to create a new ColdFusion Spreadsheet object and modify the spreadsheet contents.<br>","Attribute":[{"REQOROPT":"All","DESCRIPTION":"","default":"Required","Attribute":"action"},{"REQOROPT":"update, writer","DESCRIPTION":"","default":"Required","Attribute":"filename"},{"REQOROPT":"read","DESCRIPTION":false,"default":"Optional","Attribute":"excludeHeaderRow"},{"REQOROPT":"All","DESCRIPTION":"","default":"name or query is required.","Attribute":"name"},{"REQOROPT":"All","DESCRIPTION":"","default":"name or query is required.","Attribute":"query"},{"REQOROPT":"read","DESCRIPTION":"","default":"Required","Attribute":"src"},{"REQOROPT":"read","DESCRIPTION":"","default":"Optional","Attribute":"columns"},{"REQOROPT":"read","DESCRIPTION":"","default":"Optional","Attribute":"columnnames"},{"REQOROPT":"All","DESCRIPTION":"For read, save as a spreadsheet object. For update and write: Save a spreadsheet object.","default":"Optional","Attribute":"format"},{"REQOROPT":"read","DESCRIPTION":"","default":"Optional","Attribute":"headerrow"},{"REQOROPT":"write","DESCRIPTION":false,"default":"Optional","Attribute":"overwrite"},{"REQOROPT":"update write","DESCRIPTION":"","default":"Optional","Attribute":"password"},{"REQOROPT":"read","DESCRIPTION":"","default":"Optional","Attribute":"rows"},{"REQOROPT":"read","DESCRIPTION":"","default":"Optional","Attribute":"sheet"},{"REQOROPT":"All","DESCRIPTION":"","default":"Optional","Attribute":"sheetname"}]}