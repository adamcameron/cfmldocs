{"HISTORY":"<!-- --><br>ColdFusion 9: Added tag.<br>","SYNTAX":"<!-- --><br>&lt;cfsharepoint \r\n    action=&quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">webservice action<\/i>&quot; \r\n    params=&quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">parameter structure<\/i>&quot; \r\n    domain=&quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">domain name<\/i>&quot; \r\n    name =&quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">result variable name<\/i>&quot; \r\n    password=&quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">connection password<\/i>&quot; \r\n    userName=&quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">user ID<\/i>&quot; \r\n    wsdl=&quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">WSDL file path<\/i>&quot;&gt; \r\nor \r\n \r\n&lt;cfsharepoint \r\n    action=&quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">webservice action<\/i>&quot; \r\n    params=&quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">parameter structure<\/i>&quot; \r\n    login = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">credentials structure<\/i>&quot; \r\n    name =&quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">result variable name<\/i>&quot; \r\n    wsdl=&quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">WSDL file path<\/i>&quot;&gt;<br><span class=\"notetitle\">Note: <\/span>You can specify this tag’s attributes in an \n<samp class=\"codeph\">attributeCollection<\/samp> attribute whose value is a structure. Specify the structure name in the \n<samp class=\"codeph\">attributeCollection<\/samp> attribute and use the tag’s attribute names as structure keys.<br>","CATEGORY":"Extensibility tags, MS Office Integration tags.","PAGENAME":"cfsharepoint","SEEALSO":"","DESCRIPTION":"Invokes a feature that SharePoint exposes as a web service action, such as the Document Workspace getdwsdata action.","LICENCE":"http:\/\/help.adobe.com\/en_US\/ColdFusion\/10.0\/LegalNotices\/index.html","EXAMPLE":"<!-- --><br>The following example shows how you can manipulate lists and views. It requires resources on the SharePoint server that are not specified here.<br>&lt;!DOCTYPE HTML PUBLIC &quot;-\/\/W3C\/\/DTD HTML 4.0 Transitional\/\/EN&quot;&gt; \r\n&lt;html&gt; \r\n&lt;head&gt; \r\n    &lt;title&gt;cfsharepoint Views Example&lt;\/title&gt; \r\n&lt;\/head&gt; \r\n \r\n&lt;body&gt; \r\n&lt;cfoutput&gt; \r\n \r\nGetting the list collection&lt;br \/&gt; \r\n&lt;!--- All login information is defined using variables in the Application.cfc file. ---&gt; \r\n&lt;cfsharepoint action=&quot;getlistcollection&quot; login=&quot;#login#&quot; name=&quot;result&quot;\/&gt; \r\n \r\nresult.ResultFlag: #result.ResultFlag#&lt;br&gt;&lt;br&gt; \r\n     \r\nDeleting mycustomlist from the collection, if it exists.&lt;br&gt; \r\n&lt;cfloop array=#result.lists# index=&quot;list&quot;&gt; \r\n    &lt;cfif list.Title EQ &quot;mycustomlist&quot;&gt; \r\n        &lt;cfsharepoint action=&quot;deletelist&quot; login=&quot;#login#&quot;  \r\n         name=&quot;result1&quot; params=&quot;#{listname=&quot;mycustomlist&quot;}#&quot;\/&gt; \r\n    &lt;\/cfif&gt; \r\n&lt;\/cfloop&gt; \r\n \r\n    Was anything deleted? \r\n&lt;cfif IsDefined(&quot;result1&quot;)&gt; \r\n    &lt;b&gt;YES.&lt;\/b&gt; The result is:&lt;\/b&gt;&lt;br&gt; \r\n    &lt;cfdump var=&quot;#result1#&quot;&gt;&lt;br&gt; \r\n&lt;cfelse&gt; \r\n    &lt;b&gt;NO&lt;\/b&gt; \r\n&lt;\/cfif&gt; \r\n     \r\nAdding a mycustomlist list&lt;br \/&gt; \r\n&lt;cfsharepoint action=&quot;addlist&quot; login=&quot;#login#&quot;  name=&quot;result1&quot;  \r\n    params=&quot;#{listname=&quot;mycustomlist&quot;, \r\n        description=&quot;Adding a list via cfsharepoint&quot;, \r\n        templateid=100}#&quot;\/&gt; \r\n \r\naddlist result.ResultFlag: #result1.ResultFlag#&lt;br&gt;&lt;br&gt; \r\n \r\n     \r\n&lt;cfset viewFields = xmlparse(&quot;&lt;ViewFields&gt; \r\n                                 &lt;FieldRef Name='Title'\/&gt; \r\n                                 &lt;FieldRef Name='ID'\/&gt; \r\n                                 &lt;\/ViewFields&gt;&quot;)&gt; \r\n     \r\n&lt;cfset query = xmlparse(&quot;&lt;Query&gt; \r\n                             &lt;Where&gt; \r\n                             &lt;Lt&gt; \r\n                             &lt;FieldRef Name='ID'\/&gt; \r\n                             &lt;Value Type='Counter'&gt;10&lt;\/Value&gt; \r\n                             &lt;\/Lt&gt; \r\n                            &lt;\/Where&gt; \r\n                            &lt;OrderBy&gt; \r\n                            &lt;FieldRef Name='ID'\/&gt; \r\n                             &lt;\/OrderBy&gt; \r\n                             &lt;\/Query&gt;&quot;)&gt;        \r\n     \r\n&lt;cfset rowlimit = xmlparse(&quot;&lt;RowLimit Paged='True'&gt;50&lt;\/RowLimit&gt;&quot;)&gt; \r\n     \r\nAdding a myview1 view for the mycustomlist list&lt;br \/&gt; \r\n&lt;cfsharepoint action=&quot;addview&quot; login=&quot;#login#&quot; name=&quot;result&quot;  \r\n    params=&quot;#{listName=&quot;mycustomlist&quot;,viewname=&quot;myview1&quot;, \r\n    viewFields=&quot;#viewFields#&quot;,    query=&quot;#query#&quot;,rowlimit=&quot;#rowlimit#&quot;, \r\n    type=&quot;grid&quot;,makeViewDefault=false}#&quot;\/&gt;  \r\n \r\naddview result.ResultFlag: #result.ResultFlag#&lt;br&gt;&lt;br&gt; \r\n \r\n \r\nAdding a myview3 view for the mycustomlist list&lt;br \/&gt; \r\n&lt;cfsharepoint action=&quot;addview&quot; login=&quot;#login#&quot; name=&quot;result&quot; params=&quot;#{listName=&quot;mycustomlist&quot;,viewname=&quot;myview3&quot;,viewFields=&quot;#viewFields#&quot;, \r\n    query=&quot;#query#&quot;,rowlimit=&quot;#rowlimit#&quot;,type=&quot;grid&quot;,makeViewDefault=false}#&quot;\/&gt;  \r\n \r\naddview result.ResultFlag: #result.ResultFlag#&lt;br&gt;&lt;br&gt; \r\n     \r\nGetting the updated mycustomlist view collection&lt;br&gt; \r\n&lt;cfsharepoint action=&quot;getviewcollection&quot; login=&quot;#login#&quot; name=&quot;result&quot;  \r\n    params=&quot;#{listName=&quot;mycustomlist&quot;}#&quot;\/&gt;  \r\n \r\n&lt;b&gt;getviewcollection result&lt;\/b&gt;&lt;br&gt; \r\n&lt;cfdump var=&quot;#result#&quot;&gt;&lt;br \/&gt; \r\n \r\nThe names of the collection's views:&lt;br&gt; \r\n&lt;cfloop array=#result.views# index=v&gt; \r\n&lt;cfoutput&gt;#v.displayname#&lt;br&gt;&lt;\/cfoutput&gt; \r\n&lt;\/cfloop&gt; \r\n&lt;br&gt; \r\n \r\nDeleting the list&lt;br&gt; \r\n&lt;cfsharepoint action=&quot;deletelist&quot; login=&quot;#login#&quot; name=&quot;result1&quot; params=&quot;#{listname=&quot;mycustomlist&quot;}#&quot;\/&gt; \r\n \r\ndeletelist result.ResultFlag: #result1.ResultFlag# \r\n&lt;\/cfoutput&gt; \r\n \r\n&lt;\/body&gt; \r\n&lt;\/html&gt;<br>","USAGE":"<!-- --><br>The <samp class=\"codeph\">cfsharepoint<\/samp> tag invokes a Microsoft SharePoint web service. You call many SharePoint web service actions by specifying the action name in the <samp class=\"codeph\">action<\/samp> attribute and passing the web service parameters in the <samp class=\"codeph\">params<\/samp> attribute. You access the services and methods that the <samp class=\"codeph\">cfsharepoint<\/samp> tag does not support directly by specifying the service WSDL URLs in the <samp class=\"codeph\">wsdl<\/samp> attribute.<br><div class=\"note\">\n <span class=\"notetitle\">Note: <\/span>You can use the cfsharepoint tag with servers that use basic authentication only.\n<\/div> You request a service and action by specifying the \n<samp class=\"codeph\">action<\/samp> attribute values listed in the following tables. In nearly all cases, these are identical to the SharePoint action names. Notes indicate where the attribute values differ from the action names because multiple services have the same action name.<br><span class=\"notetitle\">Note: <\/span>The web service action parameters are documented at \n<a href=\"http:\/\/msdn.microsoft.com\/en-us\/library\/dd878586(v=office.12).aspx\" target=\"_self\">http:\/\/msdn.microsoft.com\/en-us\/library\/dd878586(v=office.12).aspx<\/a>. You can also determine the parameters from the web service WSDL, at http:\/\/server_name\/_vti_bin\/WebServiceName?wsdl.<br>When the <samp class=\"codeph\">cfsharepoint <\/samp>tag receives the results from the SharePoint server and completes, the structure specified by the <samp class=\"codeph\">name<\/samp> attribute contains the response. This structure also has a <samp class=\"codeph\">ResultFlag<\/samp> entry containing the value <samp class=\"codeph\">Success<\/samp> or <samp class=\"codeph\">Failure<\/samp>. The entry value is <samp class=\"codeph\">Success<\/samp> if there is no Axis Fault or an error is returned in the response, otherwise, the value is <samp class=\"codeph\">Failure<\/samp>.<br><strong>Document Workspace<\/strong><br><table border=\"1\" cellpadding=\"4\" cellspacing=\"0\">\n <tbody>\n  <tr>\n   <td valign=\"top\" width=\"NaN%\"><p>cancreatedwsurl<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>deletedwsfolder<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>renamedws<\/p> <\/td> \n  <\/tr> \n  <tr>\n   <td valign=\"top\" width=\"NaN%\"><p>createdws<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>finddwsdoc<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>updatedwsdata<\/p> <\/td> \n  <\/tr> \n  <tr>\n   <td valign=\"top\" width=\"NaN%\"><p>createdwsfolder<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>getdwsdata<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>&nbsp;<\/p> <\/td> \n  <\/tr> \n  <tr>\n   <td valign=\"top\" width=\"NaN%\"><p>deletedws<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>removedwsuser<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>&nbsp;<\/p> <\/td> \n  <\/tr> \n <\/tbody> \n<\/table><br><span class=\"notetitle\">Note: <\/span>The \n<samp class=\"codeph\">createdwsfolder<\/samp> and \n<samp class=\"codeph\">deletedwsfolder<\/samp> action attribute values correspond to the \n<samp class=\"codeph\">createfolder<\/samp> and \n<samp class=\"codeph\">deletefolder<\/samp> actions of the Document Workspace service.<br><strong>Imaging<\/strong><br><table border=\"1\" cellpadding=\"4\" cellspacing=\"0\">\n <tbody>\n  <tr>\n   <td valign=\"top\" width=\"NaN%\"><p>delete<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>getitemsbyids<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>upload<\/p> <\/td> \n  <\/tr> \n  <tr>\n   <td valign=\"top\" width=\"NaN%\"><p>download<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>listpicturelibrary<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>&nbsp;<\/p> <\/td> \n  <\/tr> \n  <tr>\n   <td valign=\"top\" width=\"NaN%\"><p>getimaginglistitems<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>rename<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>&nbsp;<\/p> <\/td> \n  <\/tr> \n <\/tbody> \n<\/table><br><span class=\"notetitle\">Note: <\/span>The \n<samp class=\"codeph\">getimaginglistitems<\/samp> action attribute value correspond to the \n<samp class=\"codeph\">getlistitems<\/samp> action of the Imaging service.<br><strong>Lists<\/strong><br><table border=\"1\" cellpadding=\"4\" cellspacing=\"0\">\n <tbody>\n  <tr>\n   <td valign=\"top\" width=\"NaN%\"><p>addattachment<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>getattachmentcollection<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>updatelist<\/p> <\/td> \n  <\/tr> \n  <tr>\n   <td valign=\"top\" width=\"NaN%\"><p>addlist<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>getlist<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>updatelistitems<\/p> <\/td> \n  <\/tr> \n  <tr>\n   <td valign=\"top\" width=\"NaN%\"><p>deleteattachment<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>getlistcollection<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>&nbsp;<\/p> <\/td> \n  <\/tr> \n  <tr>\n   <td valign=\"top\" width=\"NaN%\"><p>deletelist<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>getlistitems<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>&nbsp;<\/p> <\/td> \n  <\/tr> \n <\/tbody> \n<\/table><br><strong>Search or spsearch<\/strong><br><span class=\"notetitle\">Note: <\/span>spsearch\/search is not present in Windows Sharepoint Services 2.0.<br>In Windows SharePoint Services 3.0, if the action attribute specifies any of the following actions, the spsearch.asmx web service is used to perform the search. In Microsoft Office SharePoint Portal Server 2003 or Microsoft Office SharePoint Server 2007, search.asmx is used to perform the search. In Windows Sharepoint Services 2.0, an exception is thrown.<br><table border=\"1\" cellpadding=\"4\" cellspacing=\"0\">\n <tbody>\n  <tr>\n   <td valign=\"top\" width=\"NaN%\"><p>query<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>registration<\/p> <\/td> \n  <\/tr> \n  <tr>\n   <td valign=\"top\" width=\"NaN%\"><p>queryex<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>status<\/p> <\/td> \n  <\/tr> \n <\/tbody> \n<\/table><br><strong>UserGroup<\/strong><br><table border=\"1\" cellpadding=\"4\" cellspacing=\"0\">\n <tbody>\n  <tr>\n   <td valign=\"top\" width=\"NaN%\"><p>addgrouptorole<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>getgroupcollection<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>removerole<\/p> <\/td> \n  <\/tr> \n  <tr>\n   <td valign=\"top\" width=\"NaN%\"><p>addrole<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>getrolecollection<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>removeusercollectionfromgroup<\/p> <\/td> \n  <\/tr> \n  <tr>\n   <td valign=\"top\" width=\"NaN%\"><p>addusercollectiontogroup<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>getusercollectionfromrole<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>removeuserfromgroup<\/p> <\/td> \n  <\/tr> \n  <tr>\n   <td valign=\"top\" width=\"NaN%\"><p>addusercollectiontorole<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>getusercollectionfromrole<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>&nbsp;<\/p> <\/td> \n  <\/tr> \n  <tr>\n   <td valign=\"top\" width=\"NaN%\"><p>addusertogroup<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>getuserinfo<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>&nbsp;<\/p> <\/td> \n  <\/tr> \n <\/tbody> \n<\/table><br><strong>Views<\/strong><br><table border=\"1\" cellpadding=\"4\" cellspacing=\"0\">\n <tbody>\n  <tr>\n   <td valign=\"top\" width=\"NaN%\"><p>addview<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>getview<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>updateview<\/p> <\/td> \n  <\/tr> \n  <tr>\n   <td valign=\"top\" width=\"NaN%\"><p>deleteview<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>getviewcollection<\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\"><p>&nbsp;<\/p> <\/td> \n  <\/tr> \n <\/tbody> \n<\/table><br>","Attribute":[{"REQOROPT":"Required","DESCRIPTION":"The name of a web service action. See Usage for the list of service actions you can specify.","default":" ","Attribute":"action"},{"REQOROPT":"Optional","DESCRIPTION":"The domain name required to connect to the SharePoint server. Required if you do not specify a login attribute.","default":" ","Attribute":"domain"},{"REQOROPT":"Optional","DESCRIPTION":"A structure containing user, password, and domain login credentials to pass to the service. If you do not specify domain, password, and userName attributes, specify a login structure with domain, password, and userName entries.","default":" ","Attribute":"login"},{"REQOROPT":"Optional","DESCRIPTION":"Name of the result variable in which to put the data returned by the SharePoint service.","default":" ","Attribute":"name"},{"REQOROPT":"Optional","DESCRIPTION":"A structure containing names and values of the parameters to pass to the service. This attribute is required for any service that requires parameters.","default":" ","Attribute":"params"},{"REQOROPT":"Optional","DESCRIPTION":"The password required to connect to the SharePoint server. Required if you do not specify a login attribute.","default":" ","Attribute":"password"},{"REQOROPT":"Optional","DESCRIPTION":"The user name required to connect to the SharePoint server. Required if you do not specify a login attribute.","default":" ","Attribute":"userName"},{"REQOROPT":"Optional","DESCRIPTION":"Path to the service wsdl file. Required to invoke an action that is not in the list of supported actions. See Usage for details.","default":" ","Attribute":"wsdl"}]}