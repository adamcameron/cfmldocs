{"HISTORY":"<!-- --><br>ColdFusion MX 7: Added this tag.<br>","SYNTAX":"<!-- --><br>&lt;cfNTauthenticate  \r\n    domain=&quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">NT domain<\/i>&quot;  \r\n    password=&quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">password<\/i>&quot;  \r\n    username=&quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">user name<\/i>&quot;  \r\n    listGroups = &quot;yes|no&quot; \r\n    result=&quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">result variable<\/i>&quot; \r\n    throwOnError = &quot;yes|no&quot;&gt;<br><span class=\"notetitle\">Note: <\/span>You can specify this tag’s attributes in an \n<samp class=\"codeph\">attributeCollection<\/samp> attribute whose value is a structure. Specify the structure name in the \n<samp class=\"codeph\">attributeCollection<\/samp> attribute and use the tag’s attribute names as structure keys.<br>","CATEGORY":"Security tags","PAGENAME":"cfNTauthenticate","SEEALSO":"<!-- --><br><samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7db9.html\">cflogin<\/a><\/samp>, <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7c5c.html\">cfloginuser<\/a><\/samp>, <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7d95.html\">IsUserInAnyRole<\/a><\/samp>, <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7c57.html\">GetAuthUser<\/a><\/samp><br>","DESCRIPTION":"Authenticates a user name and password against the Windows NT domain on which the ColdFusion server is running, and optionally retrieves the user’s groups.","LICENCE":"http:\/\/help.adobe.com\/en_US\/ColdFusion\/10.0\/LegalNotices\/index.html","EXAMPLE":"<!-- --><br>The following example uses the auth and status fields to determine whether the user is authenticated and the failure cause. It consists of three files that you put in the same directory:<br><li><p>A main cfntauthexample.cfm page that displays the name if the user is authenticated and contains a logout link.<\/p> <\/li> \n<li><p>A login form page that is displayed if the user is not logged in.<\/p> <\/li> \n<li><p>The Application.cfm page, which contains all the login, authentication, and logout processing code.<\/p> <\/li><br>For a full description of login processing, see the <i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">Developing ColdFusion Applications<\/i>. For information on how this example works, see the comments in the code.<br>Save the following page as cfntauthenticateexample.cfm. To run the example, request this page in your browser or IDE.<br>&lt;!--- The Application.cfm page, which is processed each time a user \r\n    requests this page, ensures that you log in first. ---&gt; \r\n&lt;cfoutput&gt; \r\n    &lt;h3&gt;Welcome #GetAuthUser()#&lt;\/h3&gt; \r\n    &lt;!--- A link to log out the user. ---&gt; \r\n    &lt;a href=&quot;#CGI.script_name#?logout=Yes&quot;&gt;Log Out&lt;\/a&gt;  \r\n&lt;\/cfoutput&gt;<br>Save the following page as loginform.cfm:<br>&lt;!--- A simple login form that posts back to the page whose request initiated the login. ---&gt; \r\n&lt;h2&gt;Please Log In&lt;\/h2&gt; \r\n&lt;cfform action=&quot;#CGI.script_name#&quot;&gt; \r\n    &lt;!--- j_username and j_password are special names that populate cflogin tag \r\n        variables. ---&gt; \r\n    User Name: &lt;cfinput type=&quot;text&quot; name=&quot;j_username&quot; value=&quot;cfqa_user1&quot; required=&quot;Yes&quot;&gt;&lt;br&gt; \r\n    Password: &lt;cfinput type=&quot;password&quot; name=&quot;j_password&quot; value=&quot;cfqa_user1&quot; \r\n        required=&quot;Yes&quot;&gt;&lt;br&gt; \r\n    Domain: &lt;cfinput type=&quot;text&quot; name=&quot;domain&quot; value=&quot;rnd&quot; required=&quot;Yes&quot;&gt;&lt;br&gt; \r\n    &lt;input type=&quot;submit&quot; value=&quot;Log In&quot;&gt; \r\n&lt;\/cfform&gt;<br>Save the following page as Application.cfm:<br>&lt;!--- If this page is executing in response to the user clicking a logout link, \r\n        log out the user. The cflogin tag code will then run. ---&gt; \r\n&lt;cfif IsDefined(&quot;URL.logout&quot;) AND URL.logout&gt; \r\n    &lt;cflogout&gt; \r\n&lt;\/cfif&gt; \r\n \r\n&lt;!--- The cflogin body code runs only if a user is not logged in. ---&gt; \r\n&lt;cflogin&gt; \r\n    &lt;!--- cflogin variable exists only if login credentials are available. ---&gt; \r\n    &lt;cfif NOT IsDefined(&quot;cflogin&quot;)&gt; \r\n        &lt;!--- Show a login form that posts back to the page whose request \r\n            initiated the login, and do not process the rest of this page. ---&gt; \r\n        &lt;cfinclude template=&quot;loginform.cfm&quot;&gt; \r\n        &lt;cfabort&gt; \r\n    &lt;cfelse&gt; \r\n        &lt;!--- Trim any leading or trailing spaces from the username and password  \r\n            submitted by the form. ---&gt; \r\n        &lt;cfset theusername=trim(form.j_username)&gt; \r\n        &lt;cfset thepassword=trim(form.j_password)&gt; \r\n        &lt;cfset thedomain=trim(form.domain)&gt; \r\n        &lt;cfntauthenticate username=&quot;#theusername#&quot; password=&quot;#thepassword#&quot; \r\n            domain=&quot;#thedomain#&quot; result=&quot;authresult&quot; listgroups=&quot;yes&quot;&gt; \r\n        &lt;!--- authresult.auth is True if the user is authenticated. ---&gt; \r\n        &lt;cfif authresult.auth&gt; \r\n            &lt;!--- Log user in to ColdFusion and set roles to the user's Groups. ---&gt; \r\n            &lt;cfloginuser name=&quot;#theusername#&quot; password=&quot;#thepassword#&quot; \r\n                roles=&quot;#authresult.groups#&quot;&gt; \r\n        &lt;cfelse&gt; \r\n            &lt;!--- The user was not authenticated.  \r\n                    Display an error message and the login form. ---&gt; \r\n            &lt;cfoutput&gt; \r\n                &lt;cfif authresult.status IS &quot;AuthenticationFailure&quot;&gt; \r\n                    &lt;!--- The user is valid, but not the password. ---&gt; \r\n                    &lt;h2&gt;The password for #theusername# is not correct&lt;br&gt; \r\n                        Please Try again&lt;\/h2&gt; \r\n                &lt;cfelse&gt; \r\n                    &lt;!--- There is one other status value, invalid user name. ---&gt; \r\n                    &lt;H2&gt;The user name #theusername# is not valid&lt;br&gt; \r\n                        Please Try again&lt;\/h2&gt; \r\n                &lt;\/cfif&gt; \r\n            &lt;\/cfoutput&gt; \r\n            &lt;cfinclude template=&quot;loginform.cfm&quot;&gt; \r\n            &lt;cfabort&gt; \r\n        &lt;\/cfif&gt; \r\n    &lt;\/cfif&gt; \r\n&lt;\/cflogin&gt;<br>","USAGE":"<!-- --><br>Use this function to authenticate a user against a Windows NT domain and optionally get the user’s groups. This function does not work with the Microsoft Active Directory directory service, and does nothing on UNIX and Linux systems. You typically use this tag inside a <samp class=\"codeph\">cflogin<\/samp> tag to authenticate the user for a <samp class=\"codeph\">cfloginuser<\/samp> tag, as the example shows.<br><span class=\"notetitle\">Note: <\/span>ColdFusion must run as a user that has the privilege to authenticate other users in the specified domain.<br>The structure specified in the <samp class=\"codeph\">result<\/samp> attribute contains the following information:<br><table border=\"1\" cellpadding=\"4\" cellspacing=\"0\">\n <thead align=\"left\">\n  <tr>\n   <th valign=\"top\" width=\"NaN%\" id=\"d17e68352\"><p>Field<\/p> <\/th> \n   <th valign=\"top\" width=\"NaN%\" id=\"d17e68355\"><p>Value<\/p> <\/th> \n  <\/tr> \n <\/thead> \n <tbody>\n  <tr>\n   <td valign=\"top\" width=\"NaN%\" headers=\"d17e68352 \"><p><samp class=\"codeph\">auth<\/samp><\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\" headers=\"d17e68355 \"><p>Whether the user is authenticated:<\/p> \n    <div class=\"para\">\n     <ul>\n      <li><p><samp class=\"codeph\">yes<\/samp><\/p> <\/li> \n      <li><p><samp class=\"codeph\">no<\/samp><\/p> <\/li> \n     <\/ul> \n    <\/div> <\/td> \n  <\/tr> \n  <tr>\n   <td valign=\"top\" width=\"NaN%\" headers=\"d17e68352 \"><p><samp class=\"codeph\">groups<\/samp><\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\" headers=\"d17e68355 \"><p>A comma-delimited list of the user’s groups in the specified domain. The structure includes this field only if the <samp class=\"codeph\">listGroups<\/samp> attribute is <samp class=\"codeph\">yes<\/samp>.<\/p> <\/td> \n  <\/tr> \n  <tr>\n   <td valign=\"top\" width=\"NaN%\" headers=\"d17e68352 \"><p><samp class=\"codeph\">name<\/samp><\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\" headers=\"d17e68355 \"><p>The user name; equals the tag’s <samp class=\"codeph\">username<\/samp> attribute.<\/p> <\/td> \n  <\/tr> \n  <tr>\n   <td valign=\"top\" width=\"NaN%\" headers=\"d17e68352 \"><p><samp class=\"codeph\">status<\/samp><\/p> <\/td> \n   <td valign=\"top\" width=\"NaN%\" headers=\"d17e68355 \"><p>The authentication status. One of the following:<\/p> \n    <div class=\"para\">\n     <ul>\n      <li><p><samp class=\"codeph\">success<\/samp><\/p> <\/li> \n      <li><p><samp class=\"codeph\">UserNotInDirFailure<\/samp>: the user is not listed in the directory.<\/p> <\/li> \n      <li><p><samp class=\"codeph\">AuthenticationFailure<\/samp>: the user is in the directory, but the password is not valid.<\/p> <\/li> \n     <\/ul> \n    <\/div> <\/td> \n  <\/tr> \n <\/tbody> \n<\/table><br>This tag provides two models for handling authentication: status checking and exception handling. If the <samp class=\"codeph\">throwOnError<\/samp> attribute is <samp class=\"codeph\">no<\/samp>, use the result variable’s auth and status fields to determine whether the user was authenticated and, if not, the reason for the failure. If the <samp class=\"codeph\">throwOnError<\/samp> attribute is <samp class=\"codeph\">yes<\/samp>, ColdFusion throws an exception error if the user is not valid. In this case, use try\/catch error handling. The catch block must handle any authentication failure.<br>","Attribute":[{"REQOROPT":"Required","DESCRIPTION":"Domain against which to authenticate the user. The ColdFusion J2EE server must be running on this domain.","default":"","Attribute":"domain"},{"REQOROPT":"Required","DESCRIPTION":"User’s password.","default":"","Attribute":"password"},{"REQOROPT":"Required","DESCRIPTION":"User’s login name.","default":"","Attribute":"username"},{"REQOROPT":"Optional","DESCRIPTION":"Boolean value that specifies whether to include a comma-delimited list of the user’s groups in the result structure.","default":false,"Attribute":"listGroups"},{"REQOROPT":"Optional","DESCRIPTION":"Name of the variable in which to return the results.","default":"cfntauthenticate","Attribute":"result"},{"REQOROPT":"Optional","DESCRIPTION":"Boolean value that specifies whether to throw an exception if the validation fails. If this attribute is yes, ColdFusion throws an error if the username or password is invalid; the application must handle such errors in a try\/catch block or ColdFusion error handler page.","default":false,"Attribute":"throwOnError"}]}