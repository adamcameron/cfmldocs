{"HISTORY":"<!-- --><br>ColdFusion 8: Added this tag.<br>","SYNTAX":"<!-- --><br><strong>delete<\/strong> \r\n&lt;cfexchangemail \r\n    <strong>required<\/strong> \r\n    action = &quot;delete&quot; \r\n    uid = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">message UID,message UID,...<\/i>&quot; \r\n    <strong>optional<\/strong> \r\n    connection = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">connection ID<\/i>&quot; \r\n    folder = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">Exchange folder path<\/i>&quot;&gt; \r\n \r\n<strong>deleteAttachments<\/strong> \r\n&lt;cfexchangemail \r\n    <strong>required<\/strong> \r\n    action = &quot;deleteAttachments&quot; \r\n    uid = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">message UID<\/i>&quot; \r\n    <strong>optional<\/strong> \r\n    connection = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">connection ID<\/i>&quot;&gt; \r\n    folder = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">Exchange folder path<\/i>&quot;&gt; \r\n \r\n<strong>get<\/strong> \r\n&lt;cfexchangemail \r\n    <strong>required<\/strong> \r\n    action = &quot;get&quot; \r\n    name = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">query identifier<\/i>&quot; \r\n    <strong>optional<\/strong> \r\n    connection = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">connection ID<\/i>&quot; \r\n    folder = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">Exchange folder path<\/i>&quot;&gt; \r\n \r\n    &lt;cfexchangefilter name = &quot;filter type&quot; value = &quot;filter value&quot;&gt; \r\n    &lt;cfexchangefilter name = &quot;filter type&quot; value = &quot;filter value&quot;&gt; \r\n    ... \r\n&lt;\/cfexchangemail&gt; \r\n \r\n<strong>getAttachments<\/strong> \r\n&lt;cfexchangemail \r\n    <strong>required<\/strong> \r\n    action = &quot;getAttachments&quot; \r\n    name = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">query identifier<\/i>&quot; \r\n    uid = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">message UID<\/i>&quot; \r\n    <strong>optional<\/strong> \r\n    attachmentPath = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">directory path<\/i>&quot; \r\n    connection = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">connection ID<\/i>&quot; \r\n    folder = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">Exchange folder path<\/i>&quot; \r\n    generateUniqueFilenames = &quot;no|yes&quot;&gt; \r\n \r\n<strong>getMeetingInfo <\/strong> \r\n&lt;cfexchangemail \r\n    <strong>required<\/strong> \r\n    action = &quot;getMeetingInfo&quot; \r\n    meetingUID = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">meeting UID<\/i>&quot; \r\n    name = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">query identifier<\/i>&quot; \r\n    <strong>optional<\/strong> \r\n    connection = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">connection ID<\/i>&quot; \r\n    mailUID = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">message UID<\/i>&quot;&gt; \r\n \r\n<strong>move <\/strong> \r\n&lt;cfexchangemail \r\n    <strong>required<\/strong> \r\n    action = &quot;move&quot; \r\n    destinationFolder = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">Exchange folder path<\/i>&quot; \r\n    <strong>optional<\/strong> \r\n    connection = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">connection ID<\/i>&quot; \r\n    folder = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">Exchange folder path<\/i>&quot;&gt; \r\n \r\n    &lt;cfexchangefilter name = &quot;filter type&quot; value = &quot;filter value&quot;&gt; \r\n    &lt;cfexchangefilter name = &quot;filter type&quot; value = &quot;filter value&quot;&gt; \r\n    ... \r\n&lt;\/cfexchangemail&gt; \r\n \r\n<strong>set <\/strong> \r\n&lt;cfexchangemail \r\n    <strong>required<\/strong> \r\n    action = &quot;set&quot; \r\n    message = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">#structure with values to set#<\/i>&quot;&gt; \r\n    uid = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">message UID<\/i>&quot;&gt; \r\n    <strong>optional<\/strong> \r\n    connection = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">connection ID<\/i>&quot; \r\n    folder = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">Exchange folder path<\/i>&quot;&gt;<br><span class=\"notetitle\">Note: <\/span>If you omit the \n<samp class=\"codeph\">connection<\/samp> attribute, create a temporary connection by specifying \n<samp class=\"codeph\">cfexchangeconnection<\/samp> tag attributes in the \n<samp class=\"codeph\">cfexchangemail<\/samp> tag. In this case, ColdFusion closes the connection when the tag completes. For details, see the \n<samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-782d.html\">cfexchangeconnection<\/a><\/samp> tag \n<samp class=\"codeph\">open<\/samp> action.<br><span class=\"notetitle\">Note: <\/span>You can specify this tag’s attributes in an \n<samp class=\"codeph\">attributeCollection<\/samp> attribute whose value is a structure. Specify the structure name in the \n<samp class=\"codeph\">attributeCollection<\/samp> attribute and use the tag’s attribute names as structure keys.<br>","CATEGORY":"Communications tags","PAGENAME":"cfexchangemail","SEEALSO":"<!-- --><br><samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-782c.html\">cfexchangecalendar<\/a><\/samp><samp class=\"codeph\">,<\/samp><samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-782d.html\">cfexchangeconnection<\/a><\/samp>, <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7828.html\">cfexchangecontact<\/a><\/samp><samp class=\"codeph\">, <\/samp><samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-767a.html\">cfexchangefilter<\/a><\/samp>, <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7827.html\">cfexchangetask<\/a><\/samp>, <samp class=\"codeph\"><a href=\"http:\/\/help.adobe.com\/en_US\/ColdFusion\/9.0\/Developing\/WSc3ff6d0ea77859461172e0811cbec22c24-73ff.html\" target=\"_self\">Interacting with Microsoft Exchange Servers<\/a><\/samp> in the <i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">Developing ColdFusion Applications<\/i><br>","DESCRIPTION":"Gets mail messages and attachments, deletes messages, and sets properties for messages on a Microsoft Exchange server.","LICENCE":"http:\/\/help.adobe.com\/en_US\/ColdFusion\/10.0\/LegalNotices\/index.html","EXAMPLE":"<!-- --><br>The following example gets the attachments to all mail messages in the Inbox from docuser2 in the last week. It puts each message’s attachments in a directory with a unique name. It cannot use the UID as a filename because, for each message with attachments, the UID can contain the application reports of the UID, directory path, subject, date, and sender of the message, followed by a table that lists the message’s attachments. The table includes the attachment name, size, and MIME type.<br>&lt;!--- Index for message attachement directory ---&gt; \r\n&lt;cfset i=1&gt; \r\n&lt;!--- Dates for date range ---&gt; \r\n&lt;cfset rightNow = Now()&gt; \r\n&lt;cfset lastWeek = DateAdd(&quot;d&quot;,&quot;-7&quot;, rightNow)&gt; \r\n \r\n&lt;cfexchangeconnection \r\n    action=&quot;open&quot; \r\n    username =&quot;#user1#&quot; \r\n    password=&quot;#password1#&quot; \r\n    server=&quot;#exchangeServerIP#&quot; \r\n    connection=&quot;testconn1&quot;&gt; \r\n \r\n&lt;cfexchangemail action=&quot;get&quot; folder=&quot;Inbox &quot; name=&quot;weeksMail&quot; connection=&quot;testconn1&quot;&gt; \r\n    &lt;cfexchangefilter name=&quot;FromID&quot; value=&quot;docuser2&quot;&gt; \r\n    &lt;cfexchangefilter name=&quot;TimeSent&quot; from=&quot;#lastWeek#&quot; to=&quot;#rightNow#&quot;&gt; \r\n&lt;\/cfexchangemail&gt; \r\n \r\n&lt;cfloop query=&quot;weeksMail&quot;&gt; \r\n    &lt;cfif weeksmail.HasAttachment&gt; \r\n        &lt;cfexchangemail action=&quot;getAttachments&quot;  \r\n            connection=&quot;testconn1&quot; \r\n            folder=&quot;Inbox\/MailTest&quot; \r\n            uid=&quot;#weeksmail.uid#&quot;  \r\n            name=&quot;attachData&quot;  \r\n            attachmentPath=&quot;C:\\temp\\cf_files\\attachments\\msg_#i#&quot; \r\n            generateUniqueFilenames=&quot;yes&quot;&gt; \r\n        &lt;cfoutput&gt; \r\n            Message ID #weeksmail.uid# attachments are in the directory \r\n                C:\\temp\\cf_files\\attachments\\Msg_#i#&lt;br \/&gt; \r\n            &lt;br \/&gt; \r\n                Message information:&lt;br \/&gt; \r\n                Subject: #weeksmail.Subject#&lt;br \/&gt; \r\n                Sent: #dateFormat(weeksmail.TimeSent)#&lt;br \/&gt; \r\n                From:  #weeksmail.FromID#&lt;br \/&gt; \r\n            &lt;br \/&gt; \r\n            Attachments&lt;br \/&gt; \r\n            &lt;cftable query=&quot;attachData&quot; colheaders=&quot;yes&quot;&gt; \r\n                &lt;cfcol header=&quot;File Name&quot; text=&quot;#attachmentFilename#&quot;&gt; \r\n                &lt;cfcol header=&quot;Size&quot; text=&quot;#size#&quot;&gt; \r\n                &lt;cfcol header=&quot;MIME type&quot; text=&quot;#mimeType#&quot;&gt; \r\n            &lt;\/cftable&gt; \r\n        &lt;\/cfoutput&gt; \r\n        &lt;cfset i++&gt; \r\n    &lt;\/cfif&gt; \r\n&lt;\/cfloop&gt; \r\n&lt;cfexchangeconnection action=&quot;close&quot; connection=&quot;testconn1&quot;&gt;<br>","USAGE":"<!-- --><br>The <samp class=\"codeph\">cfexchangemail<\/samp> tag performs mail actions on an Exchange server that you cannot do by using the <samp class=\"codeph\">cfmail<\/samp> tag. (You must use the <samp class=\"codeph\">cfmail<\/samp> tag to send, forward, and reply to mail messages.) Use the <samp class=\"codeph\">cfexchangemail<\/samp> tag to perform the following actions:<br><li><p>Permanently delete one or more mail messages from the server.<\/p> <\/li> \n<li><p>Get the attachments for a specific message.<\/p> <\/li> \n<li><p>Get one or more messages that conform to an optional set of filter specifications, such as the subject, sender or recipient ID, time received, and so on.<\/p> <\/li> \n<li><p>Get the attachments for a specific message.<\/p> <\/li> \n<li><p>Get detailed information about a meeting for which you have a notification, such as a meeting request or cancellation notice.<\/p> <\/li> \n<li><p>Move one or more messages from one folder to another, including to the Deleted Items folder.<\/p> <\/li> \n<li><p>Set the properties of a specific mail message.<\/p> <\/li><br>To use this tag, you must have a connection to an Exchange server. If you are using multiple tags that interact with the exchange server, such as if you are creating several contact records, use the <samp class=\"codeph\">cfexchangeconnection<\/samp> tag to create a persistent connection. You then specify the connection identifier in each <samp class=\"codeph\">cfexchangemail<\/samp> tag, or any other ColdFusion Exchange tag, if you are also accessing tasks, contacts, or connections. Doing this saves the overhead of creating and closing the connection for each tag.<br>Alternatively, you can create a temporary connection that lasts only for the time that ColdFusion processes the single <samp class=\"codeph\">cfexchangemail<\/samp> tag. To do this, you specify the connection attributes directly in the <samp class=\"codeph\">cfexchangemail<\/samp> tag. For details on the connection attributes, see the <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-782d.html\">cfexchangeconnection<\/a><\/samp> tag.<br>","Attribute":[{"REQOROPT":"all","DESCRIPTION":"","default":"Required","Attribute":"action"},{"REQOROPT":"getAttachments","DESCRIPTION":"","default":"Optional","Attribute":"attachmentPath"},{"REQOROPT":"all","DESCRIPTION":"","default":"Optional","Attribute":"connection"},{"REQOROPT":"move","DESCRIPTION":"","default":"Required","Attribute":"destinationFolder"},{"REQOROPT":"all exceptgetMeetingInfo","DESCRIPTION":"","default":"Optional","Attribute":"folder"},{"REQOROPT":"getAttachments","DESCRIPTION":false,"default":"Optional","Attribute":"generateUniqueFilenames"},{"REQOROPT":"getMeetingInfo","DESCRIPTION":"","default":"Optional","Attribute":"mailUID"},{"REQOROPT":"getMeetingInfo","DESCRIPTION":"","default":"Required","Attribute":"meetingUID"},{"REQOROPT":"set","DESCRIPTION":"","default":"Required","Attribute":"message"},{"REQOROPT":"get getAttachments getMeetingInfo","DESCRIPTION":"","default":"Required","Attribute":"name"},{"REQOROPT":"delete getAttachments set","DESCRIPTION":"","default":"Required","Attribute":"uid"}]}